var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,i=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,o=(e,a)=>{for(var t in a||(a={}))r.call(a,t)&&i(e,t,a[t]);if(l)for(var t of l(a))s.call(a,t)&&i(e,t,a[t]);return e};import{a as n}from"./axios-c1c8d626.js";import{d,g as c,j as u,r as g,D as p,o as h,P as m,t as f,a0 as v,U as b,J as y,a1 as D,a2 as V,O as w,a as x,Z as j,b as $,n as k,B as I,e as _,f as C,w as P,_ as O,a3 as A,F,z,h as L,c as N,s as T,q as B}from"./index-7a49a29c.js";import{u as E}from"./index.esm-9d210ab7.js";import{g as R,e as S}from"./empty-c98ec24e.js";import{b as U}from"./boy-639ae26f.js";import{h as J}from"./hot-d0a3d9b9.js";import{_ as q}from"./plugin-vue_export-helper-46f75680.js";var K=d({name:"module",components:{},props:{},emits:[],setup(e,l){const{proxy:r}=c(),s=u();let i=g({moduleList:[],isloading:!0,searchValue:"",searchData:[],filterValue:[0],filterOptions:[{value:0,label:"全部"},{value:1,label:"低分辨率"},{value:2,label:"中分辨率"},{value:3,label:"高分辨率"},{value:4,label:"动态"},{value:5,label:"静态"}],currentPage:1,total:0,loadingText:"正在加载..."});const d={getFrameImg:p((()=>e=>e&&""!==e?`${y()}moduleImg${e}`:R)),getAuthorImg:p((()=>e=>"/"===e[0]?`${y()}${e.slice(1)}`:e.startsWith("http")?e:U))};let x={search(){if(""===i.searchValue.trim())return r.$message.warning("请输入搜索词");i.isloading=!0,i.loadingText="正在搜索...",x.handleFilter(i.filterValue)},handleDownload({projectId:e,projectName:a,frameImg:t}){n.get(`${y()}project/${e}.json`).then((e=>{let l=e.data;l.frameImg=t,D(JSON.stringify(l),"application/json",a)})).catch((e=>{r.$message.error("下载失败 - "+e)}))},handleCurrentChange(e){i.currentPage=e,x.getData()},getData(){i.isloading=!0,n.get(`${y()}json/module${i.currentPage}.json`).then((e=>{i.total=e.data.total,i.moduleList=V(e.data.data,"createAt"),x.handleFilter(i.filterValue)})).catch((e=>{r.$message.error(e),i.isloading=!1}))},filterData(e,a,t){let l=new RegExp(i.searchValue,"i");return e.filter((e=>""!==i.searchValue?(l.test(e.data.projectName)||l.test(e.data.desc))&&e.data.width*e.data.height<=a&&e.data.width*e.data.height>t:e.data.width*e.data.height<=a&&e.data.width*e.data.height>t))},filterData2(e,a){let t=new RegExp(i.searchValue,"i");return e.filter((e=>""!==i.searchValue?(t.test(e.data.projectName)||t.test(e.data.desc))&&e.data.tag.includes(a):e.data.tag.includes(a)))},handleFilter(e){if(i.isloading=!0,i.filterValue.length<=0&&(i.filterValue=[0]),i.filterValue.length>1)if(0===i.filterValue[i.filterValue.length-1])i.filterValue=[0];else{let e=i.filterValue.findIndex((e=>0===e));e>=0&&i.filterValue.splice(e,1)}if(i.searchData=[],i.filterValue.includes(0)&&(i.searchData=[...i.searchData,...x.filterData(i.moduleList,4900,36)]),i.filterValue.includes(1)&&(i.searchData=[...i.searchData,...x.filterData(i.moduleList,400,36)]),i.filterValue.includes(2)&&(i.searchData=[...i.searchData,...x.filterData(i.moduleList,1600,400)]),i.filterValue.includes(3)&&(i.searchData=[...i.searchData,...x.filterData(i.moduleList,4900,1600)]),i.filterValue.includes(4)){x.filterData2(i.moduleList,1).forEach((e=>{i.searchData.find((a=>a.id===e.id))||i.searchData.push(e)}))}if(i.filterValue.includes(5)){x.filterData2(i.moduleList,0).forEach((e=>{i.searchData.find((a=>a.id===e.id))||i.searchData.push(e)}))}i.isloading=!1},handleReset(){i.searchValue="",i.filterValue=[0],x.handleFilter(i.filterValue)},handlePreview(e){i.isloading=!0,i.loadingText="正在打开项目",r.$router.push({name:"preview",params:{projectId:e.projectId}})},handleImport(e){n.get(`${y()}project/${e.projectId}.json`).then((e=>{let a=e.data;a.createAt=w(),a.updateAt=a.createAt,a.projectId=E.v1(),a.tip="新项目",a.isTop=0,s.saveProject(a).then((e=>{e&&r.$message.success(r.$t("message.importSucceeded")+"，请在我的项目中查看")})).catch((e=>{r.$message.error(r.$t("message.importFailed"))}))})).catch((e=>{r.$message.error("导入失败 - "+e)}))}};return h((()=>{x.getData()})),m((()=>{""===i.searchValue.trim()&&x.handleFilter(i.filterValue),i.searchData.length&&(i.isloading=!1)})),o((j=o(o({},f(i)),x),a(j,t({Download:v,ArrowDownBold:b}))),d);var j}});const W={class:"full-layout scrollbar routerview flex-center"},Z=["element-loading-text"],G={class:"flex-start searchBox"},H={class:"input-search"},M={style:{"margin-left":"5px"}},Q={key:0,class:"full-layout scrollbar grid-box scrollAuto"},X={class:"frameImg"},Y=["src"],ee={class:"author flex-start"},ae=["src"],te={class:"oneline"},le={class:"info"},re={class:"flex-between",style:{"padding-bottom":"5px"}},se=["title"],ie={class:"twoline",style:{"font-size":"14px",display:"-webkit-inline-box"}},oe={key:1,class:"full-layout flex-center scrollbar scrollAuto"};var ne=q(K,[["render",function(e,a,t,l,r,s){const i=x("Search"),o=x("el-icon"),n=x("el-option"),d=x("el-select"),c=x("el-pagination"),u=x("el-skeleton-item"),g=x("el-skeleton"),p=x("el-image"),h=x("el-tag"),m=x("el-button"),f=x("el-dropdown-item"),v=x("el-dropdown-menu"),b=x("el-dropdown"),y=x("el-divider"),D=x("el-tooltip"),V=x("el-empty"),w=j("loading");return $(),k("div",W,[I(($(),k("div",{class:"full-layout flex flex-column","element-loading-text":e.loadingText,"element-loading-background":"#00000000"},[_("div",G,[_("div",H,[C(o,null,{default:P((()=>[C(i)])),_:1}),I(_("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=a=>e.searchValue=a),placeholder:"请搜索像素资源",onKeyup:a[1]||(a[1]=O(((...a)=>e.search&&e.search(...a)),["enter"]))},null,544),[[A,e.searchValue]])]),C(d,{modelValue:e.filterValue,"onUpdate:modelValue":a[2]||(a[2]=a=>e.filterValue=a),placeholder:"请选择分类",size:"large",onChange:e.handleFilter,class:"select","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":3,multiple:""},{default:P((()=>[($(!0),k(F,null,z(e.filterOptions,(e=>($(),N(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),_("button",{class:"pixelButton",onClick:a[3]||(a[3]=(...a)=>e.handleReset&&e.handleReset(...a))},"重 置"),_("div",M,[C(c,{"current-page":e.currentPage,"onUpdate:current-page":a[4]||(a[4]=a=>e.currentPage=a),"page-size":15,background:"",layout:"total, prev, pager, next","hide-on-single-page":!0,total:e.total,onCurrentChange:e.handleCurrentChange},null,8,["current-page","total","onCurrentChange"])])]),e.searchData.length&&!e.isloading?($(),k("div",Q,[($(!0),k(F,null,z(e.searchData,(a=>($(),k("div",{key:a.id,class:"download-item"},[_("div",X,[C(p,{src:e.getFrameImg(a.data.frameImg),fit:"contain"},{placeholder:P((()=>[C(g,{animated:"",class:"full-layout"},{template:P((()=>[C(u,{variant:"image",style:{height:"100%"}})])),_:1})])),_:2},1032,["src"]),a.data.isTop?($(),k("img",{key:0,src:J,class:"top"},null,8,Y)):L("",!0),C(h,{type:"success",class:"size"},{default:P((()=>[T(B(a.data.width)+"x"+B(a.data.height),1)])),_:2},1024),""!==a.data.tip?($(),N(h,{key:1,type:"danger",class:"tip"},{default:P((()=>[T(B(a.data.tip),1)])),_:2},1024)):L("",!0),_("div",ee,[_("img",{src:e.getAuthorImg(a.author.avatar)},null,8,ae),_("p",te,B(a.author.nickname),1)])]),_("div",le,[_("div",re,[_("h4",{class:"oneline",title:a.data.projectName},B(a.data.projectName),9,se),C(b,{trigger:"click",size:"small"},{dropdown:P((()=>[C(v,null,{default:P((()=>[C(f,{onClick:t=>e.handleDownload(a.data),icon:"Download"},{default:P((()=>[T(B(e.$t("message.download")),1)])),_:2},1032,["onClick"]),C(f,{onClick:t=>e.handleImport(a.data),icon:"FolderAdd"},{default:P((()=>[T(B(e.$t("message.import")),1)])),_:2},1032,["onClick"]),C(f,{onClick:t=>e.handlePreview(a.data),icon:"View"},{default:P((()=>[T(B(e.$t("message.preview")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),default:P((()=>[C(m,{type:"primary",icon:e.ArrowDownBold,size:"small",style:{"margin-left":"5px"}},null,8,["icon"])])),_:2},1024)]),C(y,{"border-style":"dashed","content-position":"left",style:{margin:"5px 0"}},{default:P((()=>[T(B(a.data.createAt),1)])),_:2},1024),C(D,{content:a.data.desc,effect:"light"},{default:P((()=>[_("div",ie,B(a.data.desc),1)])),_:2},1032,["content"])])])))),128))])):e.isloading||e.searchData.length?L("",!0):($(),k("div",oe,[C(V,{image:S,description:"空空如也","image-size":200},null,8,["image"])]))],8,Z)),[[w,e.isloading]])])}],["__scopeId","data-v-a5ad6b42"]]);export{ne as default};
